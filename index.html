<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EtherSniper | Sistema de Controle</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        :root { --primary: #F0B90B; --bg: #0b0e11; --card: #1e2329; --text: #EAECEF; --green: #0ECB81; --red: #F6465D; }
        body { margin: 0; font-family: 'Segoe UI', Roboto, sans-serif; background-color: var(--bg); color: var(--text); height: 100vh; overflow: hidden; display: flex; }
        
        /* TELA DE LOGIN */
        #login-screen { position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; background: var(--bg); display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .login-box { background: var(--card); padding: 40px; border-radius: 16px; width: 320px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid #333; }
        .login-box input { width: 100%; padding: 12px; margin: 10px 0; background: #2b3139; border: 1px solid #474d57; color: white; border-radius: 4px; box-sizing: border-box; }
        .btn-login { width: 100%; padding: 12px; background: var(--primary); color: black; font-weight: bold; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; font-size: 16px; }
        .btn-login:hover { opacity: 0.9; }

        /* MENU LATERAL */
        .sidebar { width: 260px; background: var(--card); display: flex; flex-direction: column; border-right: 1px solid #2b3139; }
        .logo { padding: 30px 20px; font-size: 22px; font-weight: bold; color: var(--primary); display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #2b3139; }
        .menu { padding: 20px 0; flex: 1; }
        .menu-item { padding: 15px 25px; cursor: pointer; color: #848e9c; display: flex; align-items: center; gap: 15px; transition: 0.2s; font-size: 16px; }
        .menu-item:hover, .menu-item.active { background: #2b3139; color: var(--primary); border-right: 3px solid var(--primary); }
        .user-info { padding: 20px; border-top: 1px solid #2b3139; color: #5e6673; font-size: 12px; text-align: center; }

        /* CONTE√öDO PRINCIPAL */
        .main-content { flex: 1; padding: 40px; overflow-y: auto; display: none; } /* Escondido at√© logar */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .status-badge { background: rgba(14, 203, 129, 0.15); color: var(--green); padding: 5px 12px; border-radius: 4px; font-size: 13px; font-weight: bold; border: 1px solid rgba(14, 203, 129, 0.3); }

        /* CARDS DE DADOS */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: var(--card); padding: 25px; border-radius: 12px; border: 1px solid #2b3139; }
        .card-title { color: #848e9c; font-size: 14px; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .card-value { font-size: 28px; font-weight: 600; color: var(--text); }
        .green-text { color: var(--green); }
        .red-text { color: var(--red); }

        /* ABAS */
        .tab-section { display: none; animation: fadeIn 0.3s; }
        .tab-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* LOGS */
        .log-list { list-style: none; padding: 0; font-family: 'Consolas', monospace; font-size: 14px; }
        .log-item { padding: 10px 0; border-bottom: 1px solid #2b3139; color: #848e9c; display: flex; justify-content: space-between; }
        .log-time { color: #5e6673; margin-right: 15px; }

        /* IA CONFIG */
        select { background: #0b0e11; color: white; border: 1px solid #474d57; padding: 10px; width: 100%; border-radius: 4px; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="logo" style="border:none; font-size: 30px; margin-bottom: 20px;">
            <i class="fas fa-crosshairs"></i> EtherSniper
        </div>
        <div class="login-box">
            <h3 style="margin-top: 0; color: #fff;">Acesso Seguro</h3>
            <input type="email" id="email" placeholder="E-mail de Administrador">
            <input type="password" id="password" placeholder="Senha">
            <button class="btn-login" onclick="fazerLogin()">ACESSAR PAINEL</button>
            <p id="msg-erro" style="color: var(--red); font-size: 13px; margin-top: 15px;"></p>
        </div>
    </div>

    <div class="sidebar" id="sidebar" style="display: none;">
        <div class="logo"><i class="fas fa-crosshairs"></i> EtherSniper</div>
        <div class="menu">
            <div class="menu-item active" onclick="nav('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</div>
            <div class="menu-item" onclick="nav('ia')"><i class="fas fa-robot"></i> Configura√ß√£o IA</div>
            <div class="menu-item" onclick="nav('logs')"><i class="fas fa-list-ul"></i> Hist√≥rico</div>
        </div>
        <div class="user-info" id="user-display">Usu√°rio: ...</div>
    </div>

    <div class="main-content" id="app-content">
        
        <div class="header">
            <div>
                <h2 style="margin:0;">Painel de Controle</h2>
                <span style="color: #848e9c; font-size: 14px;">Simula√ß√£o Ativa: Dia <span id="dia-topo">1</span> de 15</span>
            </div>
            <div class="status-badge"><i class="fas fa-wifi"></i> Conectado √† Binance</div>
        </div>

        <div id="dashboard" class="tab-section active">
            <div class="stats-grid">
                <div class="card">
                    <div class="card-title">Banca Atual</div>
                    <div class="card-value" id="banca-val">R$ 1.500,00</div>
                </div>
                <div class="card">
                    <div class="card-title">Lucro L√≠quido</div>
                    <div class="card-value green-text" id="lucro-val">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-title">Pr√≥xima An√°lise</div>
                    <div class="card-value" style="font-size: 20px; color: #f0b90b;">Em 5 segundos...</div>
                </div>
            </div>
            
            <div class="card" style="height: 300px; display: flex; align-items: center; justify-content: center; background: linear-gradient(180deg, #1e2329 0%, #161a1e 100%);">
                <div style="text-align: center; color: #5e6673;">
                    <i class="fas fa-chart-area" style="font-size: 40px; margin-bottom: 10px;"></i><br>
                    Gr√°fico em Tempo Real (Conex√£o via API Binance)
                </div>
            </div>
        </div>

        <div id="ia" class="tab-section">
            <div class="card" style="max-width: 500px;">
                <h3 style="margin-top: 0;">Estrat√©gia do Algoritmo</h3>
                <p style="color: #848e9c; font-size: 14px;">Defina como a IA deve se comportar com sua banca.</p>
                
                <label style="font-size: 12px; color: #848e9c;">PERFIL DE RISCO</label>
                <select id="perfil-risco">
                    <option value="conservador">üõ°Ô∏è Conservador (Meta 1-3% m√™s)</option>
                    <option value="moderado" selected>‚öñÔ∏è Moderado (Padr√£o)</option>
                    <option value="agressivo">üöÄ Agressivo (Alto Risco)</option>
                </select>

                <label style="font-size: 12px; color: #848e9c; display: block; margin-top: 15px;">PAR PRINCIPAL</label>
                <select>
                    <option>ETH/USDT</option>
                    <option>BTC/USDT</option>
                </select>

                <button class="btn-login" style="margin-top: 20px;" onclick="salvarConfig()">Salvar Altera√ß√µes</button>
            </div>
        </div>

        <div id="logs" class="tab-section">
            <div class="card">
                <h3 style="margin-top: 0; border-bottom: 1px solid #2b3139; padding-bottom: 15px;">Registro de Opera√ß√µes</h3>
                <ul class="log-list" id="lista-logs">
                    <li class="log-item">
                        <span class="log-time">00:00:01</span>
                        <span>Sistema iniciado. Chaves Binance carregadas com seguran√ßa.</span>
                    </li>
                </ul>
            </div>
        </div>

    </div>

    <script>
        // --- 1. CONFIGURA√á√ÉO (J√° preenchida com os dados que voc√™ enviou) ---
        const firebaseConfig = {
            apiKey: "AIzaSyAx9DPXLOCvJmgRRKlladRC-NRbxJmj0SE",
            authDomain: "ethersniper.firebaseapp.com",
            projectId: "ethersniper",
            storageBucket: "ethersniper.firebasestorage.app",
            messagingSenderId: "68071456710",
            appId: "1:68071456710:web:053ce6921ea0de77c57cc7",
            measurementId: "G-19282VJVDM"
        };

        // Inicializa Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- 2. SISTEMA DE LOGIN ---
        function fazerLogin() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            
            // Login simples (anonimo ou email)
            auth.signInWithEmailAndPassword(email, pass)
                .then(() => {
                    console.log("Logado!");
                })
                .catch((error) => {
                    // Se n√£o tiver conta criada, cria uma automaticamente para facilitar seu teste
                    if(error.code === 'auth/user-not-found') {
                        auth.createUserWithEmailAndPassword(email, pass).then(u => window.location.reload());
                    } else {
                        document.getElementById('msg-erro').innerText = "Erro: " + error.message;
                    }
                });
        }

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('sidebar').style.display = 'flex';
                document.getElementById('app-content').style.display = 'block';
                document.getElementById('user-display').innerText = "Admin: " + user.email;
                iniciarSimulacao();
            }
        });

        // --- 3. NAVEGA√á√ÉO ---
        function nav(aba) {
            document.querySelectorAll('.tab-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            document.getElementById(aba).classList.add('active');
            
            // Atualiza visual do menu
            const iconMap = {'dashboard': 0, 'ia': 1, 'logs': 2};
            document.querySelectorAll('.menu-item')[iconMap[aba]].classList.add('active');
        }

        function salvarConfig() {
            alert("Configura√ß√£o de IA salva com sucesso!");
        }

        // --- 4. MOTOR DO SNIPER (Simula√ß√£o 15 Dias) ---
        let banca = 1500.00;
        let dia = 1;

        function iniciarSimulacao() {
            // Verifica se j√° temos as chaves seguras (Simula√ß√£o de leitura do DB)
            db.collection('segredos').doc('binance').get().then((doc) => {
                if(doc.exists) {
                    addLog("Chaves da Binance verificadas no banco de dados.");
                } else {
                    addLog("Aviso: Chaves n√£o encontradas no banco.");
                }
            });

            setInterval(() => {
                if(dia > 15) return;

                // Simula lucro/preju√≠zo leve
                let variacao = (Math.random() * 0.05) - 0.015; // -1.5% a +3.5%
                let resultado = banca * variacao;
                banca += resultado;
                
                let lucroTotal = banca - 1500;

                // Atualiza tela
                document.getElementById('banca-val').innerText = "R$ " + banca.toFixed(2);
                document.getElementById('lucro-val').innerText = "R$ " + lucroTotal.toFixed(2);
                document.getElementById('lucro-val').className = "card-value " + (lucroTotal >= 0 ? "green-text" : "red-text");
                document.getElementById('dia-topo').innerText = dia;

                // Registra log
                let tipo = resultado >= 0 ? "LUCRO" : "PREJU√çZO";
                let icon = resultado >= 0 ? "üü¢" : "üî¥";
                addLog(`${icon} Dia ${dia}: Opera√ß√£o finalizada. ${tipo}: R$ ${resultado.toFixed(2)}`);

                // Salva no banco
                db.collection("testes").doc("dia_"+dia).set({
                    banca: banca,
                    lucro: lucroTotal,
                    data: new Date()
                });

                dia++;
            }, 5000); // 1 dia = 5 segundos na simula√ß√£o
        }

        function addLog(texto) {
            const ul = document.getElementById('lista-logs');
            const li = document.createElement('li');
            li.className = 'log-item';
            
            const agora = new Date();
            const time = agora.getHours() + ":" + agora.getMinutes() + ":" + agora.getSeconds();
            
            li.innerHTML = `<span class="log-time">${time}</span><span>${texto}</span>`;
            ul.prepend(li);
        }
    </script>
</body>
</html>
